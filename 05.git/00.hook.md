# 00.hook | Git Hook 实战指南

Git Hooks 是 Git 提供的自动化钩子机制，允许用户在 Git 的生命周期事件（如提交前、合并后等）触发脚本操作，适用于自动化校验、格式化、构建或通知等场景。

---

## 🧭 常见 Hook 场景

| Hook 类型  | 触发时机     | 常见用途                 |
| ---------- | ------------ | ------------------------ |
| pre-commit | 提交前       | 代码格式检查、lint、测试 |
| commit-msg | 提交信息校验 | 校验 message 格式规范    |
| pre-push   | push 前      | 检查分支、运行测试       |
| post-merge | 合并代码后   | 自动构建、通知、依赖安装 |

---

## 🛠️ 启用 Hook 的方式

1. 进入 `.git/hooks` 目录
2. 复制对应脚本（如 `pre-commit.sample` → `pre-commit`）
3. 添加执行权限：`chmod +x pre-commit`

---

## 🔧 示例：pre-commit Hook（lint 检查）

```bash
#!/bin/sh
echo "🔍 Running pre-commit lint check..."
npm run lint
if [ $? -ne 0 ]; then
  echo "❌ Lint failed. Commit aborted."
  exit 1
fi
```

---

## 🔧 示例：commit-msg Hook（提交格式校验）

```bash
#!/bin/sh
msg=$(cat "$1")
if ! echo "$msg" | grep -qE "^(feat|fix|docs|refactor|chore):"; then
  echo "❌ 提交信息不规范：必须以 'feat|fix|docs|refactor|chore:' 开头"
  exit 1
fi
```

---

## 💡 实战建议

- 将项目级 hook 脚本统一托管到 `scripts/hooks/`，并使用初始化脚本软链接到 `.git/hooks/`
- 推荐使用工具：`husky`、`lefthook`、`lint-staged`
- 可结合 CI 工具将本地 hook 校验同步为流水线阶段校验

---

## 📦 常用 hook 文件列表

- `.git/hooks/pre-commit`
- `.git/hooks/commit-msg`
- `.git/hooks/pre-push`
- `.git/hooks/post-merge`

> ✅ 建议将 hook 模块作为 Git 工作流中的第一道防线，提升提交质量与协作稳定性。
